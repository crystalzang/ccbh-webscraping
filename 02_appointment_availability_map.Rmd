---
title: "02_appointmetn_availability_map"
author: "Crystal Zang"
date: '2023-02-02'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:



```{r}
library(readr)
library(dplyr)
library(tidyverse)
library(sf)
library(mapview)
library(RColorBrewer)
library(leafpop)

data <- read.csv("data/data.csv")
```


```{r}
data_plot <- data%>%
  filter(!is.na(long))%>%
  mutate( AppointmentAvailability = ifelse(liveperson_appt_available ==T, "Available(Live Person)", 
                                           ifelse(voicemail_appt_available==T, "Available(Voicemail)", "Not Available")))%>%
  mutate(AppointmentAvailability = ifelse(is.na(AppointmentAvailability), "Not Available", AppointmentAvailability))%>%
  select(-liveperson_appt_available, -voicemail_appt_available)

data_sf <- st_as_sf(data_plot, coords = c("long", "lat"))

st_crs(data_sf) <- 4326 # we can use EPSG as numeric here

mapviewOptions()

mapview(data_sf, xcol = "long", ycol = "lat",
        zcol = "AppointmentAvailability" , 
       
        popup = popupTable(data_sf),
        crs = 4326, grid = FALSE)

```

